<div class="container">
<div class="analysis-content">
  <div class="filter-section">
    <div class="filters">
      <mat-form-field>
        <mat-label>IDs:</mat-label>
        <mat-select [multiple]="true" [value]="analysisStateService.selectedIds()"
          (selectionChange)="analysisStateService.updateSelectedIds($event.value)">
          <mat-option *ngFor="let id of analysisStateService.availableIds()" [value]="id">
            {{id.id}} {{id.name}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="filters">
      <mat-form-field>
      <mat-label>Subjects:</mat-label>
        <mat-select [multiple]="true" [value]="analysisStateService.selectedSubjects()"
          (selectionChange)="analysisStateService.updateSelectedSubjects($event.value)">
          <mat-option *ngFor="let subject of availableSubjects()" [value]="subject.value">
            {{subject.viewValue}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </div>

  <div class="charts-grid">
    <div cdkDropList cdkDropListOrientation="horizontal" class="charts-container" (cdkDropListDropped)="drop($event)">
      <div class="chart-box" *ngFor="let chart of analysisStateService.visibleCharts()" cdkDrag>
        <div [ngSwitch]="chart.id">
          {{chart.id}}
          <app-chart-grades-average *ngSwitchCase="'chart1'"
            [selectedTrainee]="analysisStateService.selectedIds()"></app-chart-grades-average>
          <app-chart-students-averages *ngSwitchCase="'chart2'"
            [selectedTrainee]="analysisStateService.selectedIds()"></app-chart-students-averages>
          <app-chart-grades-avg-subject *ngSwitchCase="'chart3'"
            [selectedSubjects]="analysisStateService.selectedSubjects()"></app-chart-grades-avg-subject>
        </div>
      </div>
    </div>
  </div>

  <div class="hidden-charts">
    <div *ngFor="let chart of analysisStateService.hiddenCharts()" class="hidden-chart-button" cdkDrag
      (cdkDragEnded)="onHiddenChartDragEnded($event, chart)">
      {{chart.title}}
    </div>
  </div>
</div>
</div>